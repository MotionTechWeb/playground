<!doctype html>
<html lang="ja">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>画像圧縮ツール</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/gh/jnordberg/gif.js/dist/gif.js" defer></script>
    <script src="https://cdn.jsdelivr.net/gh/jnordberg/gif.js/dist/gif.worker.js" defer></script>
    <script src="script.js" type="module" defer></script>
</head>

<body>
    <header class="app-header">
        <h1>画像圧縮ツール</h1>
        <p class="sub">ローカル処理・ドラッグ&ドロップ・一括ZIPダウンロード対応</p>
    </header>

    <main class="container">
        <section class="controls" aria-label="圧縮設定">
            <div class="field">
                <label for="maxEdge">幅（px）</label>
                <input id="maxEdge" type="number" min="64" max="12000" step="1" value="1920" />
            </div>

            <div class="field">
                <label for="format">出力形式</label>
                <select id="format">
                    <option value="image/webp" selected>WebP（推奨）</option>
                    <option value="image/png">PNG（透過維持）</option>
                    <option value="image/jpeg">JPEG（写真向け）</option>
                    <option value="image/gif">GIF（静止画のみ）</option>
                </select>
            </div>

            <div class="field">
                <label for="quality">品質（0.1〜1.0）</label>
                <input id="quality" type="range" min="0.1" max="1" step="0.05" value="0.8" />
                <span id="qualityVal" class="mono">0.80</span>
                <small id="qualityNote" class="note">※WebP/JPEGのみ有効</small>
            </div>

            <div class="field">
                <label for="bgColor">不透明背景（JPEG/GIF用 透過時の塗りつぶし）</label>
                <input id="bgColor" type="color" value="#ffffff" />
            </div>

            <div class="actions">
                <label class="btn">
                    画像を選択
                    <input id="fileInput" type="file" accept="image/*" multiple hidden />
                </label>
                <button id="clearBtn" class="btn btn-secondary">一覧をクリア</button>
                <button id="reencodeAllBtn" class="btn btn-secondary">再エンコード（現在設定を全適用）</button>
                <button id="downloadAllBtn" class="btn btn-primary">すべてZIPでダウンロード</button>
            </div>
        </section>

        <section class="dropzone" id="dropzone" aria-label="ドロップ領域" tabindex="0">
            <p><strong>ここに画像をドラッグ＆ドロップ</strong>（または上の「画像を選択」）</p>
            <p class="muted">JPEG / PNG / GIF（アニメGIFはフレーム保持不可、静止画化されます）</p>
        </section>

        <section id="progress" class="progress" aria-live="polite" aria-atomic="true"></section>

        <section class="preview" id="preview" aria-label="プレビュー一覧"></section>
    </main>

    <footer class="app-footer">
        <small>すべてブラウザ内で処理します。画像は外部送信されません。</small>
    </footer>
</body>

</html>